<!DOCTYPE html><html domain="serafdev.github.io" lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="default-src 'self';object-src 'none';script-src 'self' 'sha256-Ky9qZOPnMhQV/s7Fdb9TYAOfU4KtWNqCZaFK8tSzXa0=';style-src 'unsafe-inline';img-src 'self' data:" http-equiv="Content-Security-Policy"><link href="/img/favicon/favicon-192x192.png?hash=2089033c93" rel="icon" type="image/png"><meta content="#f9c412" name="theme-color"><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name="robots"><title>Learn DevOps by deploying a Minecraft Server</title><meta content="Learn DevOps by deploying a Minecraft Server" property="og:title"><meta content="Learn about high availability services, CI/CD, Linux Services, Dynamic DNS and some more DevOps and sysadmin tasks, just by deploying your..." name="description"><meta content="Learn about high availability services, CI/CD, Linux Services, Dynamic DNS and some more DevOps and sysadmin tasks, just by deploying your..." property="og:description"><meta content="summary_large_image" name="twitter:card"><meta content="@@serafdev" name="twitter:site"><meta content="@@serafdev" name="twitter:creator"><link href="https://serafdev.github.io/posts/2020-03-30-learn-devops-by-deploying-a-minecraft-server/" rel="canonical"><meta content="no-referrer-when-downgrade" name="referrer"><link href="/feed/feed.xml" rel="alternate" type="application/atom+xml" title="Fares' Blog"><link href="/" rel="preconnect" crossorigin=""><script async="" defer="" src="/js/min.js?hash=54e8a28837"></script><script csp-hash="sha256-Ky9qZOPnMhQV/s7Fdb9TYAOfU4KtWNqCZaFK8tSzXa0=">if (/Mac OS X/.test(navigator.userAgent))document.documentElement.classList.add('apple')</script><style>:root{--primary: #f9c412;--primary-dark: #E7BF60;--main-width: calc(100vw - 3em)}main img{content-visibility:auto}header nav{position:fixed;padding:.375em 1.5em;background:rgba(255,255,255,.9);font-weight:200;text-align:right}@media (min-width:37.5em){:root{--main-width: calc(37.5em - 3em)}}dialog,share-widget{position:fixed;opacity:.9}share-widget{right:20px;bottom:20px}share-widget div{width:30px;height:30px;background-image:url(/img/share.svg);background-repeat:no-repeat;background-position:center}.apple share-widget div{background-image:url(/img/share-apple.svg)}body,share-widget button{margin:0}share-widget button:active{transform:scale(1.2)}dialog{background-color:#8dff80}header aside{font-style:italic}#nav{z-index:2;position:relative}#reading-progress,header nav{z-index:1;width:100vw;left:0;top:0}#reading-progress{background-color:var(--primary);position:absolute;bottom:0;transform:translate(-100vw,0);will-change:transform;pointer-events:none}#posts li{margin-bottom:.5em}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:100;src:url(/fonts/Inter-Thin.woff2) format("woff2"),url(/fonts/Inter-Thin.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:100;src:url(/fonts/Inter-ThinItalic.woff2) format("woff2"),url(/fonts/Inter-ThinItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:200;src:url(/fonts/Inter-ExtraLight.woff2) format("woff2"),url(/fonts/Inter-ExtraLight.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:200;src:url(/fonts/Inter-ExtraLightItalic.woff2) format("woff2"),url(/fonts/Inter-ExtraLightItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:300;src:url(/fonts/Inter-Light.woff2) format("woff2"),url(/fonts/Inter-Light.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:300;src:url(/fonts/Inter-LightItalic.woff2) format("woff2"),url(/fonts/Inter-LightItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:400;src:url(/fonts/Inter-Regular.woff2) format("woff2"),url(/fonts/Inter-Regular.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:400;src:url(/fonts/Inter-Italic.woff2) format("woff2"),url(/fonts/Inter-Italic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:500;src:url(/fonts/Inter-Medium.woff2) format("woff2"),url(/fonts/Inter-Medium.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:500;src:url(/fonts/Inter-MediumItalic.woff2) format("woff2"),url(/fonts/Inter-MediumItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:600;src:url(/fonts/Inter-SemiBold.woff2) format("woff2"),url(/fonts/Inter-SemiBold.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:600;src:url(/fonts/Inter-SemiBoldItalic.woff2) format("woff2"),url(/fonts/Inter-SemiBoldItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:700;src:url(/fonts/Inter-Bold.woff2) format("woff2"),url(/fonts/Inter-Bold.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:700;src:url(/fonts/Inter-BoldItalic.woff2) format("woff2"),url(/fonts/Inter-BoldItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:800;src:url(/fonts/Inter-ExtraBold.woff2) format("woff2"),url(/fonts/Inter-ExtraBold.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:800;src:url(/fonts/Inter-ExtraBoldItalic.woff2) format("woff2"),url(/fonts/Inter-ExtraBoldItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:900;src:url(/fonts/Inter-Black.woff2) format("woff2"),url(/fonts/Inter-Black.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:900;src:url(/fonts/Inter-BlackItalic.woff2) format("woff2"),url(/fonts/Inter-BlackItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI var alt';font-weight:100 900;font-style:normal;font-named-instance:'Regular';src:url(/fonts/Inter-roman.var.woff2) format("woff2")}@font-face{font-display:swap;font-family:'Inter UI var alt';font-weight:100 900;font-style:italic;font-named-instance:'Italic';src:url(/fonts/Inter-italic.var.woff2) format("woff2")}button,html{line-height:1.15}html{-webkit-text-size-adjust:100%}h1{font-size:3em;line-height:1.25;margin:.67em 0 .5em;font-size:2.074rem;line-height:2.4rem;margin-bottom:1.36rem}a{background-color:transparent;color:#f9c412;text-decoration:none;color:var(--primary)}small{font-size:80%;color:#ccc}img{border-style:none;max-width:100%;height:auto;margin:0 auto}button{font-family:inherit;font-size:100%;overflow:visible;text-transform:none}[type=button],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}details{display:block}body,p,pre,ul{font-size:1em}p,pre,ul{margin-bottom:1.5em}body,p,pre,ul{font-size:1rem;line-height:1.6}p,pre,ul{margin-bottom:1.36rem}@media (min-width:600px){h1{font-size:4.3978rem;line-height:4.4rem}body,p,pre,ul{font-size:1.1rem;line-height:1.6}h1,p,pre,ul{margin-bottom:1.496rem}}@media (min-width:1200px){h1{font-size:6.0756rem;line-height:6.72rem}body,p,pre,ul{font-size:1.2rem;line-height:1.6}h1,p,pre,ul{margin-bottom:1.632rem}}code,pre{overflow-x:auto}pre{font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace}pre code:not([class]){padding:1.5em;overflow-x:scroll}button,code{border-radius:.3em}code{color:#e2777a;padding:0 .3em;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:90%;background:#2d2d2d}h1,html{font-family:Inter UI,sans-serif}a:hover{text-decoration:underline}@media (max-width:767px){x:-moz-any-link{display:table-cell}}@supports (font-variation-settings:normal){html{font-family:Inter UI var alt,sans-serif}}button{max-width:100%;background:#f2f2f2;color:#191919;cursor:pointer;display:inline-block;padding:.75em 1.5em;text-align:center;margin:0 .75em 1.5em 0}button:hover{background:#d9d9d9;color:#000}button:not([disabled]){background:#f9c412;color:#181818;background:var(--primary)}button:not([disabled]):hover{background:#ba9005;color:#000;background:var(--primary-dark)}*{border:0;box-sizing:border-box}body,header nav a{font-family:Inter UI,sans-serif}body{background:#181818;color:#eee}header{padding:4.5em 1.5em 3em;width:37.5em;margin:0 auto;text-align:center;max-width:100%;display:flex;align-items:center;flex-direction:column}header p,ul{margin-top:0}header nav h1{float:left;font-size:inherit;line-height:inherit;margin:0;text-align:left}header nav a{font-weight:700;text-decoration:none;color:#181818;margin-left:1.5em}header nav a:first-of-type{margin-left:auto}header nav a:last-of-type{margin-right:1.5em}main{max-width:70rem;margin:0 auto;border-top:.5px solid #ccc}footer{background:rgba(0,0,0,.8);color:#fff;padding:3em;text-align:center}footer>*{margin:1.5em}footer nav a img{vertical-align:middle}footer nav,footer p{font-size:90%}article{max-width:100%;padding:1.5em;width:37.5em;margin:0 auto}li ul{margin-bottom:0}blockquote{border-left:1px solid #f9c412;padding:0 1.5em;margin:1.5em 0 1.5em 1.5em;border-left:1px solid var(--primary)}blockquote footer{background:0 0;display:block;color:#ccc;padding:.75em 0;font-size:90%;text-align:start}</style></head><body><header><nav><div id="nav"><h1><a href="/" title="Homepage">Fares' Blog</a></h1><a href="/about/">About</a></div><div id="reading-progress" aria-hidden="true"></div></nav><h1>Learn DevOps by deploying a Minecraft Server</h1><aside>15 min read.</aside><dialog id="message"></dialog></header><main><article><p>Learn about high availability services, CI/CD, Linux Services, Dynamic DNS and some more DevOps and sysadmin tasks, just by deploying your Minecraft server and automating the configuration files deployment.</p><p>This is a beginner friendly tutorial aimed for everyone with hopes to enlighten everyone on the job of a DevOps engineer by going through your first (or not) automated deployment. For more advanced readers, you can skim through most paragraphs because they will go into details on explaining every corner.</p><h1 id="prerequisites">Prerequisites <a href="#prerequisites" class="direct-link">#</a></h1><ul><li>A machine running Ubuntu</li><li>A GitHub account</li><li>Access to your router’s ports management (for the ports forwarding)</li></ul><p>Install Ubuntu on any of your machines.</p><p>At the time of this writing my setup looks like this: A small server right by my router in the corner of my dining room, running Ubuntu Server 18.04. You can use a spare Laptop or a Raspberry Pie, really, anything will do. For this tutorial, if you are already on Linux, you can just use your current installation.</p><p>For the GitHub account, you can just visit the official website to create an account.</p><p>You will also need to do some port forwarding so people can access your Minecraft server from outside your home network, also for having GitHub actions accessing your server for the automated deployments.</p><p>Details on all of these will come through the article.</p><h1 id="set-up">Set up <a href="#set-up" class="direct-link">#</a></h1><p>On your Linux machine, create a folder named /opt/minecraft and change it’s ownership to your main user. What this means is that the folder will be modifiable by you without the need to use super user privileges (sudo), to do so you can do:</p><blockquote><p>sudo mkdir /opt/minecraft</p></blockquote><blockquote><p>sudo chown $USER /opt/minecraft</p></blockquote><p>This is where we will put our Minecraft server. Go ahead and download the server archive using “wget”, you can find the link at the page bellow by clicking on the green download button under Ubuntu Server Software for Ubuntu and hitting “Copy Link”, you can do that on another machine if you’re using Ubuntu Server, and just write it down there: <a href="https://www.minecraft.net/en-us/download/server/bedrock/">https://www.minecraft.net/en-us/download/server/bedrock/</a></p><p>At the time of writing, the command looks like this, make sure to use the latest version:</p><blockquote><p>wget <a href="https://minecraft.azureedge.net/bin-linux/bedrock-server-1.14.32.1.zip">https://minecraft.azureedge.net/bin-linux/bedrock-server-1.14.32.1.zip</a> -P /tmp/</p></blockquote><p>-P /tmp/ is used to basically tell wget to put the file in the /tmp/ directory (P for prefix).</p><p>Install unzip if you don’t already have it,</p><blockquote><p>sudo apt install unzip</p></blockquote><p>Now we can unzip the content of that file inside the folder we created earlier</p><blockquote><p>unzip /tmp/bedrock-server-1.14.32.1.zip -d /opt/minecraft</p></blockquote><p>Test your installation using:</p><blockquote><p>cd /opt/minecraft &amp;&amp; chmod +x ./bedrock_server &amp;&amp; LD_LIBRARY_PATH=. ./bedrock_server</p></blockquote><p>Basically, we go into the folder, we change the mod of the bedrock_server file to executable and run the server with environment variable LD_LIBRARY_PATH set to current location. Pretty simple when someone puts some words to those cryptic commands right?</p><p>If the app runs smoothly, you should see a logstack like this one:</p><blockquote><p>NO LOG FILE! — setting up server logging…<br>[2020–03–29 23:14:30 INFO] Starting Server<br>[2020–03–29 23:14:30 INFO] Version 1.14.32.1<br>[2020–03–29 23:14:30 INFO] Session ID f6b04942–72ed-414d-88d3–024ad4c8683c<br>[2020–03–29 23:14:30 INFO] Level Name: Bedrock level<br>[2020–03–29 23:14:30 INFO] Game mode: 0 Survival<br>[2020–03–29 23:14:30 INFO] Difficulty: 1 EASY<br>[2020–03–29 23:14:30 INFO] opening worlds/Bedrock level/db<br>[2020–03–29 23:14:32 INFO] IPv4 supported, port: 19132<br>[2020–03–29 23:14:32 INFO] IPv6 supported, port: 19133<br>[2020–03–29 23:14:32 INFO] IPv4 supported, port: 57890<br>[2020–03–29 23:14:32 INFO] IPv6 supported, port: 40946<br>[2020–03–29 23:14:33 INFO] Server started.</p></blockquote><p>Hurray! We’re ready for the fun part.</p><h1 id="the-minecraft-service-(linux-daemon)">The Minecraft Service (Linux Daemon) <a href="#the-minecraft-service-(linux-daemon)" class="direct-link">#</a></h1><p>A quick explanation of what a daemon is, it is just an application that runs in the background. Basically it logs nothing to your standard output (eh, generally, because you can hack a daemon that spams and takes control of your standard output if you want, but that’s beside the point). We want this because we don’t want to have to go manually open a terminal or a background terminal and run our Minecraft server. We are too lazy for that, we will automate everything.</p><p>Here’s how our Minecraft Service looks like, I will explain every part afterwards.</p><pre><code>[Unit]
Description=Minecraft Server
After=network.target

[Service]
User=minecraft
Group=minecraft

Type=Simple

WorkingDirectory=/opt/minecraft
ExecStart=/bin/sh -c "LD_LIBRARY_PATH=. ./bedrock_server"
TimeoutStopSec=20
Restart=on-failure

[Install]
WantedBy=multi-user.target
</code></pre><p>First we have the Description, After means, we want this service to run after the network is ready.</p><p>In Service, we have our User and Group, replace these by yours. To find out in what group you’re in you can just run the command “group” on the shell, you will see a list of those, just pick the one named after your user. To keep it simple, Type=Simple (nice dad pun) means that the process running on ExecStart is the main process of this service. The WorkingDirectory is the working directory which is the location of our server /opt/minecraft.</p><p>ExecStart is the command we tested before, sh -c means run this command as interpreted by sh. /bin/sh is the absolute path of shell. Timeout, is just the timeout of no response when it has to stop gracefully, and Restart=on-failure, means if there’s a crash it will try to restart again, if you stop it manually it will not restart except on reboot if you enable the service.</p><p>Let’s test this! I have setup a repository for this, so go ahead and clone it.</p><blockquote><p>git clone <a href="https://github.com/serafss2/mineconf.git">https://github.com/serafdev/mineconf.git</a> ~/mineconf</p></blockquote><p>Modify the minecraft.service file to put your User and Group, we will use nano for this but you can also use emacs or vi if you are comfortable with any other editor.</p><blockquote><p>nano ~/mineconf/minecraft.service</p></blockquote><p>“CTRL+x, Y, ENTER” to save your changes.</p><p>Now let’s make a symbolic link to that file and put it in the services folder so it can be recognized by systemctl (services tool)</p><blockquote><p>ln -s $HOME/mineconf/minecraft.service /etc/systemd/system/minecraft.service</p></blockquote><p>Now your service should be ready to be started and enabled. Enabling a service makes it run when system boots.</p><blockquote><p>sudo systemctl start minecraft</p></blockquote><blockquote><p>sudo systemctl enable minecraft</p></blockquote><p>You can check if the server started successfully with</p><blockquote><p>sudo systemctl status minecraft</p></blockquote><p>Now that’s working, we need to add a user to the whitelist so you can have him access the server! Go ahead and add yourself, open ~/mineconf/whitelist.json and add yourself in it. For Minecraft Bedrock server the content should look like this:</p><pre><code>[
  {
    "ignoresPlayerLimit": false,
    "name": "AUser",
    "uuid": "erf895cc-9x7v-7da5-fasd–asgaasqwe2214"
  }
]
</code></pre><p>To findout what your uuid is you can paste your username into any Minecraft user lookup, it’ll give all the info. Here’s one: <a href="https://mcuuid.net/">https://mcuuid.net/</a></p><p>Now link that file to your minecraft server installation and restart the server:</p><blockquote><p>rm /opt/minecraft/whitelist.json</p></blockquote><blockquote><p>ln -s $HOME/mineconf/whitelist.json /opt/minecraft/whitelist.json</p></blockquote><blockquote><p>sudo systemctl restart minecraft</p></blockquote><p>Yeahh, now you’ve got your own minecraft server running in your home. Let’s test it! Go to another device in your home network, make sure you’re connected to the same network because we did not setup port forwarding and Dynamic DNS yet (more into these next), and log in to Minecraft, on the Server tab you should be able to see your Server online! Grreeat :) I personally play on both Windows and iPhone, my brother plays on Android and Windows and my other brother plays on the Nintendo Switch, and we can all join the same server! Pretty cool in my opinion!</p><p>Okay, now let’s make it accessible from the outside world</p><h1 id="port-forwarding">Port Forwarding <a href="#port-forwarding" class="direct-link">#</a></h1><p>Log in to your router, usually 192.168.0.1 or 192.168.0.2, look in the advance settings and Port Forwarding, sadly every router has it’s own specific settings so you might be better looking on duckduck.go “Port Forwarding<router model="">” or just looking around yourself, add Port 19132 TCP/UDP forwarded to 19132 Your-Minecraft-Machine, do the same for Port 22 TCP forwarded to 22 Your-Minecraft-Machine.</router></p><p>To just briefly explain what this is about, it is about accessing your server from the outside world. When someone writes your IP Address on minecraft, it will redirect the traffic to your router, but your router doesn’t know what to do with that address, because the address is your whole network’s IP Address. So basically with Port Forwarding, you tell your router “If someone contacts us at port 22 or 19132, redirect the traffic to the minecraft machine”, it should be fairly simple to setup.</p><p>After you done that, let’s test it out! (I really like tests). Connect your PC or Mobile phone that runs minecraft to your LTE or hotspot connection (make sure to set the limit on Windows to 100MB or something low like that to not consume your whole data in case you forget downloads in the background). Go ahead and look at your external IP, on your minecraft machine, just run this command: <code>curl ifconfig.me</code> Click Add Server in minecraft and write that address down, put 19132 for the port.</p><p>Yeahhh, you can already tell your friends to log into your server! You can take a small break and go build a house, playing minecraft is part of the tutorial.</p><h1 id="dynamicdns">DynamicDNS <a href="#dynamicdns" class="direct-link">#</a></h1><p>Okay, now that you built your first house and waiting until the zombies go away because you have no bed yet. Let’s deal with the Dynamic IP issue. Common ISPs distribute ephemeral IP addresses to non-businesses, what this means is that if your router goes down and back up, you will be assigned a new IP Address and will have to go through getting the new IP and distributing it to your friends again, this is very annoying, this is what I used to do in college because I did not know much about basic networking.</p><p>DynamicDNS is a feature domain providers provide for this exact problem, first let’s explain what DNS is. Basically the Domain Name System (DNS) is just like your contacts app, you got the name and some more information about your contact like his phone number, in this case it is just the IP Address that is assigned by your ISP (Internet Service Provider), so basically, instead of writing IP Addresses when we access websites, we instead write names and DNS servers will go get the IP address and bring us back the content we requested. Now, DynamicDNS is the same thing, but one of your computers in your home tells your Domain provider “Hey dude, I got a new IP Address, can you record this to the (decentralized) contact list?” This way, you won’t care if the IP Address changes.</p><p>Personally, I have my own domains, they can go as low as 11 dollars (or even less), I use them for my emails and business, but for this tutorial we will go ahead and use noip. Go ahead and make a free account at <a href="https://www.noip.com/client/linux/noip-duc-linux.tar.gz">https://www.noip.com/</a>. Finish all the initial setup and go on the DynamicDNS tab, pick your hostname and click next, fill in the information they ask you, put Minecraft Server or just skip the second step, pick yes for Device always connected on the network, click on download the DUC, it will show the steps on how to install the app that will update the DNS automatically.</p><p>I will add the commands here, but you basically can just follow their tutorial for this. At this time, we’re at version 2.1.9, but for the 4th step, you can write no-ip- and hit tab to autocomplete.</p><blockquote><p><a href="https://www.noip.com/client/linux/noip-duc-linux.tar.gz">wget https://www.noip.com/client/linux/noip-duc-linux.tar.gz</a> -P /usr/local/src</p></blockquote><blockquote><p>cd /usr/local/src</p></blockquote><blockquote><p>tar xzf noip-duc-linux.tar.gz</p></blockquote><blockquote><p>cd no-ip-2.1.9</p></blockquote><blockquote><p>make</p></blockquote><blockquote><p>make install</p></blockquote><p>Now you can create the configuration file using</p><blockquote><p>/usr/local/bin/noip2 -C</p></blockquote><p>Enter your username, password and hostname.</p><p>Now launch the app:</p><blockquote><p>/usr/local/bin/noip2</p></blockquote><p>Make it launch at startup, create a service like the one we did earlier and put it in /etc/systemd/system/noip2.service</p><p>I found one that works, a gist from Nathan Giesbrecht, so copy the bellow content and put it inside that file and then start and enable:</p><blockquote><p>nano /etc/systemd/system/noip2.service</p></blockquote><pre><code># Simple No-ip.com Dynamic DNS Updater
#
# By Nathan Giesbrecht (http://nathangiesbrecht.com)
#
# 1) Install binary as described in no-ip.com's source file (assuming results in /usr/local/bin)
# 2) Run sudo /usr/local/bin/noip2 -C to generate configuration file
# 3) Copy this file noip2.service to /etc/systemd/system/
# 4) Execute `sudo systemctl daemon-reload`
# 5) Execute `sudo systemctl enable noip2`
# 6) Execute `sudo systemctl start noip2`
#
# systemd supports lots of fancy features, look here (and linked docs) for a full list:
#   http://www.freedesktop.org/software/systemd/man/systemd.exec.html

[Unit]
Description=No-ip.com dynamic IP address updater
After=network.target
After=syslog.target

[Install]
WantedBy=multi-user.target
Alias=noip.service

[Service]
# Start main service
ExecStart=/usr/local/bin/noip2
Restart=always
Type=forking
</code></pre><blockquote><p>sudo systemctl start noip2</p></blockquote><blockquote><p>sudo systemctl enable noip2</p></blockquote><p>All right, let’s go back to the noip dashboard. Click on DynamicDNS -&gt; No-IP Hostnames. You should see an update to the “Last Update” column and your External IP/Target beside it, greeaat! This look pretty cool. At this time, you already know what will happen. Test time! Go ahead and do the Hotspot thing we earlier did.</p><p>Cool, now we have a fully functional Minecraft service. We learned about DynamicDNS, IP Forwarding, Linux Daemons and systemctl and a few Linux commands, this looks neat! Good job so far. You can already get comfortable now in your world.</p><p>You can already start thinking on high availability. Now that you know when your computer restarts, your No-IP and Minecraft Server daemons will kick right in, you can go and tweak your motherboard settings. For example I set 2 things that help me in case of outage or server down, I set the “Boot when electricity comes back” and “WLAN (Wake On Lan)”, this is very nice for when you’re on vacation and your home loses electricity, your computer will boot right back when electricity comes back. the WLAN part is when I shutdown intentionally my PC knowing that no one will login (e.g everyone’s on vacation or something) and then I happen to need to turn my server back on, I just need to contact it and my motherboard will just turn on, notified by my network card that stays on. I don’t really use this feature because I really let my PC online 24/7, but it is still something cool to consider in some situations.</p><h1 id="continuous-deployment-%E2%80%94-github-actions">Continuous Deployment — GitHub Actions <a href="#continuous-deployment-%E2%80%94-github-actions" class="direct-link">#</a></h1><p>Now, let’s use the tools we put in place so far into action (such unfunny puns).</p><p>First, let’s make the command “sudo systemctl restart minecraft” not prompt us for a password, run:</p><blockquote><p>sudo visudo</p></blockquote><p>Add at the end of the file:</p><blockquote><p>yourusername ALL=(ALL) NOPASSWD: systemctl restart minecraft</p></blockquote><p>As you remember we cloned mineconf to the home directory of the server, that repository contains the pipeline for deployment. We will first need to create a repository and push that into it. Go ahead on Github and create a private repository, name it like you want, I suggest mineconf so you remember to come back to my repo once in a while and update your files!</p><p>We also need to add your server SSH public key to your github account, this is needed for pulling the git changes without password prompt, for that you can fork from this tutorial and go ahead follow these steps: <a href="https://help.github.com/en/github/authenticating-to-github/adding-a-new-ssh-key-to-your-github-account">https://help.github.com/en/github/authenticating-to-github/adding-a-new-ssh-key-to-your-github-account</a></p><p>Okay, so now your repo is located at <a href="mailto:git@github.com">git@github.com</a>:username/mineconf.git (change username with yours), let’s update the mineconf repo that we pulled earlier, run these commands to modify the remote url and push the repo content to it:</p><blockquote><p>cd ~/mineconf</p></blockquote><blockquote><h1 id="replace-username-by-your-username-underneath">replace username by your username underneath <a href="#replace-username-by-your-username-underneath" class="direct-link">#</a></h1></blockquote><blockquote><p>git remote set-url origin <a href="mailto:git@github.com">git@github.com</a>:username/mineconf.git</p></blockquote><blockquote><p>git push</p></blockquote><p>Now, in the earlier steps, you created a pair ssh keys, copy the one inside ~/.ssh/id_rsa, which is your private key (Keep it private, it is VERY dangereous to share that) and put it inside the Github Secrets of your Repo, at the same time you should add the HOST (hostname you created in no-ip2) and your linux user username, here how it should look like:<br><img alt="" src="/content/images/2020/05/image-21.png"><br>Ouff, this was a lot to digest. Take your time understanding every step. Also it is very important to audit anything you get from open source, you can check and dig into the Actions I wrote, the services you copy pasted and so on.</p><p>Let’s look at how they look on the time of writing this:</p><pre><code>name: Minecraft Config CI/CD

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Test SSH Command
      uses: appleboy/ssh-action@v0.0.7
      with:
        # Goes into your configuration files and gets the latest changes from github
        script: cd ~/mineconf &amp;&amp; git stash &amp;&amp; git pull &amp;&amp; sudo systemctl restart minecraft &amp;&amp; ls -la
        host: $
        username: $
        key: $
</code></pre><p>Here the “on” keyword means trigger on push and pull request on branch master, I only put one job which is a deployment and runs on an ubuntu machine, the first step checksout to our branch and the second step runs a command via SSH which goes into the mineconf folder, stashes the local changes, pulls the newest changes and restarts minecraft. I added ls -la to show a log on the github actions, helps with debugging etc.</p><blockquote><p>cd ~/mineconf &amp;&amp; git stash &amp;&amp; git pull &amp;&amp; sudo systemctl restart minecraft &amp;&amp; ls -la</p></blockquote><p>For now it is a fairly basic pipeline, I (or anyone, it’s open source) will eventually added tests (because I freaking love tests) and documentation, this will make the deployments more robust, if someone makes a typo and breaks the whitelist file, it will block at the test level. You can already imagine how limitless the options are!</p><p>This is a typical pipeline that you would write with any tool like gitlab CI, Github Actions, Ansible, etc. They have different namings and stuff but it’s the same thing.<br><img alt="" src="/img/remote/pWX13-0*b_YRCmB33_3mdkwL.gif">Them Pipelines man<br>Next, let’s activate them! Go to ~/mineconf and rename .github_ to .github (I have deactivated it on the public repository by adding a _ at the end)</p><blockquote><p>cd ~/mineconf</p></blockquote><blockquote><p>mv .github_ .github</p></blockquote><p>Add these changes and push to your repo</p><blockquote><p>git add .github .github_</p></blockquote><blockquote><p>git add whitelist.json</p></blockquote><p>git commit -m “Activated Github Actions and added User to whitelist.json”</p><p>(whitelist.json keeps getting overrided by the Minecraft Server and messes up with the format, I usually just do a git stash when it’s the only change because I want to keep my json formatted correctly, but since it’s the first time we push it, add it to the repo to not lose the user you added)</p><p>Now that should’ve automatically triggered the automated deployment. Go ahead into the github repository in the Actions Tab, it should look like this:<br><img alt="" src="/content/images/2020/05/image-22.png"><br>I can see there that my brother updated the whitelist.json and his friend is now playing on our server, I should get more RAM.</p><p>Now to finish up, we need to make a symlink for the server properties so you can play with it on Github, and the permissions.json. You can easily go ahead and remove the files that exist on the server and create the symlinks:</p><blockquote><p>rm /opt/minecraft/permissions.json /opt/minecraft/server.properties</p></blockquote><blockquote><p>ln -s $HOME/mineconf/server.properties /opt/minecraft/server.properties</p></blockquote><blockquote><p>ln -s $HOME/mineconf/permissions.json /opt/minecraft/permissions.json</p></blockquote><blockquote><p>sudo systemctl restart minecraft</p></blockquote><p>There you go! You are ready to roll, now, if you need to add someone to your whitelist, you just need to add it directly from the online GitHub GUI. No need to bother with SSHing etc. That’s a good feeling, and that’s the feeling that every DevOps or Developer look for, things that took minutes, hours or days to accomplish, now takes 11 seconds.</p><h1 id="conclusion">Conclusion <a href="#conclusion" class="direct-link">#</a></h1><p>Okay, we learned about running a server, changing file permissions, connecting, ssh keys, automated deployments, DynamicDNS, Port Forwarding. That pretty much covers the whole DevOps job thingy. You’re ready to go to that interview with confidence now, the day to day job doesn’t look very different to this, might get a bit more complicated sometimes but there’s always a simple solution.</p><p>I hope you enjoyed your read and learned stuff along the way! Don’t hesitate leaving a comment if you find that I went too fast somewhere or need more clarifications or even if you just found a typo or a mistake!</p><h1>🙏🙏🙏</h1><p>Since you've made it this far, <a href="https://serafdev.github.io/posts/2020-03-30-learn-devops-by-deploying-a-minecraft-server/" on-click="share">sharing</a> this article on your favorite social media network would be highly appreciated 💖! For feedback, please <a href="https://twitter.com/@serafdev" rel="noopener" target="_blank">ping me on Twitter.</a></p><share-widget><button aria-label="Share" href="https://serafdev.github.io/posts/2020-03-30-learn-devops-by-deploying-a-minecraft-server/" on-click="share"><div></div></button></share-widget><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Learn DevOps by deploying a Minecraft Server","image":["https://serafdev.github.io/content/images/2020/05/image-21.png","https://serafdev.github.io/img/remote/pWX13-0*b_YRCmB33_3mdkwL.gif","https://serafdev.github.io/content/images/2020/05/image-22.png"],"author":"Fares B.","genre":"Insert a schema.org genre","publisher":{"@type":"Organization","name":"Seraf Development.","logo":{"@type":"ImageObject","url":"/img/favicon/favicon-192x192.png?hash=2089033c93"}},"url":"https://serafdev.github.io/posts/2020-03-30-learn-devops-by-deploying-a-minecraft-server/","mainEntityOfPage":"https://serafdev.github.io/posts/2020-03-30-learn-devops-by-deploying-a-minecraft-server/","datePublished":"2020-03-30","dateModified":"2020-10-26","description":"Learn about high availability services, CI/CD, Linux Services, Dynamic DNS and some more DevOps and sysadmin tasks, just by deploying your..."}</script><p>Published <time datetime="2020-03-30">30 Mar 2020</time></p></article></main><footer><a href="/about/">Fares B.</a></footer></body></html>