<!DOCTYPE html><html domain="serafdev.github.io" lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="default-src 'self';object-src 'none';script-src 'self' 'sha256-Ky9qZOPnMhQV/s7Fdb9TYAOfU4KtWNqCZaFK8tSzXa0=';style-src 'unsafe-inline';img-src 'self' data:" http-equiv="Content-Security-Policy"><link href="/img/favicon/favicon-192x192.png?hash=2089033c93" rel="icon" type="image/png"><meta content="#f9c412" name="theme-color"><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name="robots"><title>Deploy an nginx server</title><meta content="Deploy an nginx server" property="og:title"><meta content="Deploy an nginx server # I'll show you in this guide how to deploy an nginx server with detailed explanation on what's happening. This guide..." name="description"><meta content="Deploy an nginx server # I'll show you in this guide how to deploy an nginx server with detailed explanation on what's happening. This guide..." property="og:description"><meta content="summary_large_image" name="twitter:card"><meta content="@@serafdev" name="twitter:site"><meta content="@@serafdev" name="twitter:creator"><link href="https://serafdev.github.io/posts/2019-03-11-Deploy-an-nginx-server/" rel="canonical"><meta content="no-referrer-when-downgrade" name="referrer"><link href="/feed/feed.xml" rel="alternate" type="application/atom+xml" title="Fares' Blog"><link href="/" rel="preconnect" crossorigin=""><script async="" defer="" src="/js/min.js?hash=54e8a28837"></script><script csp-hash="sha256-Ky9qZOPnMhQV/s7Fdb9TYAOfU4KtWNqCZaFK8tSzXa0=">if (/Mac OS X/.test(navigator.userAgent))document.documentElement.classList.add('apple')</script><style>:root{--primary: #f9c412;--primary-dark: #E7BF60;--main-width: calc(100vw - 3em)}main img{content-visibility:auto}header nav{position:fixed;padding:.375em 1.5em;background:rgba(255,255,255,.9);font-weight:200;text-align:right}@media (min-width:37.5em){:root{--main-width: calc(37.5em - 3em)}}dialog,share-widget{position:fixed;opacity:.9}share-widget{right:20px;bottom:20px}share-widget div{width:30px;height:30px;background-image:url(/img/share.svg);background-repeat:no-repeat;background-position:center}.apple share-widget div{background-image:url(/img/share-apple.svg)}body,share-widget button{margin:0}share-widget button:active{transform:scale(1.2)}dialog{background-color:#8dff80}header aside{font-style:italic}#nav{z-index:2;position:relative}#reading-progress,header nav{z-index:1;width:100vw;left:0;top:0}#reading-progress{background-color:var(--primary);position:absolute;bottom:0;transform:translate(-100vw,0);will-change:transform;pointer-events:none}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:100;src:url(/fonts/Inter-Thin.woff2) format("woff2"),url(/fonts/Inter-Thin.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:100;src:url(/fonts/Inter-ThinItalic.woff2) format("woff2"),url(/fonts/Inter-ThinItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:200;src:url(/fonts/Inter-ExtraLight.woff2) format("woff2"),url(/fonts/Inter-ExtraLight.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:200;src:url(/fonts/Inter-ExtraLightItalic.woff2) format("woff2"),url(/fonts/Inter-ExtraLightItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:300;src:url(/fonts/Inter-Light.woff2) format("woff2"),url(/fonts/Inter-Light.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:300;src:url(/fonts/Inter-LightItalic.woff2) format("woff2"),url(/fonts/Inter-LightItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:400;src:url(/fonts/Inter-Regular.woff2) format("woff2"),url(/fonts/Inter-Regular.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:400;src:url(/fonts/Inter-Italic.woff2) format("woff2"),url(/fonts/Inter-Italic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:500;src:url(/fonts/Inter-Medium.woff2) format("woff2"),url(/fonts/Inter-Medium.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:500;src:url(/fonts/Inter-MediumItalic.woff2) format("woff2"),url(/fonts/Inter-MediumItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:600;src:url(/fonts/Inter-SemiBold.woff2) format("woff2"),url(/fonts/Inter-SemiBold.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:600;src:url(/fonts/Inter-SemiBoldItalic.woff2) format("woff2"),url(/fonts/Inter-SemiBoldItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:700;src:url(/fonts/Inter-Bold.woff2) format("woff2"),url(/fonts/Inter-Bold.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:700;src:url(/fonts/Inter-BoldItalic.woff2) format("woff2"),url(/fonts/Inter-BoldItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:800;src:url(/fonts/Inter-ExtraBold.woff2) format("woff2"),url(/fonts/Inter-ExtraBold.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:800;src:url(/fonts/Inter-ExtraBoldItalic.woff2) format("woff2"),url(/fonts/Inter-ExtraBoldItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:900;src:url(/fonts/Inter-Black.woff2) format("woff2"),url(/fonts/Inter-Black.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:900;src:url(/fonts/Inter-BlackItalic.woff2) format("woff2"),url(/fonts/Inter-BlackItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI var alt';font-weight:100 900;font-style:normal;font-named-instance:'Regular';src:url(/fonts/Inter-roman.var.woff2) format("woff2")}@font-face{font-display:swap;font-family:'Inter UI var alt';font-weight:100 900;font-style:italic;font-named-instance:'Italic';src:url(/fonts/Inter-italic.var.woff2) format("woff2")}button,html{line-height:1.15}html{-webkit-text-size-adjust:100%}h1{font-size:3em;line-height:1.25;margin:.67em 0 .5em;font-size:2.074rem;line-height:2.4rem;margin-bottom:1.36rem}a{background-color:transparent;color:#f9c412;text-decoration:none;color:var(--primary)}img{border-style:none;max-width:100%;height:auto;margin:0 auto}button{font-family:inherit;font-size:100%;overflow:visible;text-transform:none}[type=button],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}h3{font-size:2em;line-height:1.125;margin-bottom:.75em;font-size:1.4rem}h4{font-size:1.5em;margin-bottom:1em;line-height:1.5em}body,p,pre{font-size:1em}p,pre{margin-bottom:1.5em}h3,h4{line-height:1.6rem;margin-bottom:1.36rem}h4{font-size:1.2rem}body,p,pre{font-size:1rem;line-height:1.6}p,pre{margin-bottom:1.36rem}@media (min-width:600px){h1{font-size:4.3978rem;line-height:4.4rem}h3{font-size:2.1989rem;line-height:2.64rem}h4{font-size:1.5554rem;line-height:1.76rem}body,p,pre{font-size:1.1rem;line-height:1.6}h1,h3,h4,p,pre{margin-bottom:1.496rem}}@media (min-width:1200px){h1{font-size:6.0756rem;line-height:6.72rem}h3{font-size:2.7rem;line-height:2.88rem}h4{font-size:1.8rem;line-height:1.92rem}body,p,pre{font-size:1.2rem;line-height:1.6}h1,h3,h4,p,pre{margin-bottom:1.632rem}}code,pre{overflow-x:auto}pre{font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace}pre code:not([class]){padding:1.5em;overflow-x:scroll}button,code{border-radius:.3em}code{color:#e2777a;padding:0 .3em;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:90%;background:#2d2d2d}h1,h3,h4,html{font-family:Inter UI,sans-serif}h4{font-style:italic}a:hover{text-decoration:underline}@supports (font-variation-settings:normal){html{font-family:Inter UI var alt,sans-serif}}button{max-width:100%;background:#f2f2f2;color:#191919;cursor:pointer;display:inline-block;padding:.75em 1.5em;text-align:center;margin:0 .75em 1.5em 0}button:hover{background:#d9d9d9;color:#000}button:not([disabled]){background:#f9c412;color:#181818;background:var(--primary)}button:not([disabled]):hover{background:#ba9005;color:#000;background:var(--primary-dark)}*{border:0;box-sizing:border-box}body,header nav a{font-family:Inter UI,sans-serif}body{background:#181818;color:#eee}header{padding:4.5em 1.5em 3em;width:37.5em;margin:0 auto;text-align:center;max-width:100%;display:flex;align-items:center;flex-direction:column}header p{margin-top:0}header nav h1{float:left;font-size:inherit;line-height:inherit;margin:0;text-align:left}header nav a{font-weight:700;text-decoration:none;color:#181818;margin-left:1.5em}header nav a:first-of-type{margin-left:auto}header nav a:last-of-type{margin-right:1.5em}main{max-width:70rem;margin:0 auto;border-top:.5px solid #ccc}footer{background:rgba(0,0,0,.8);color:#fff;padding:3em;text-align:center}footer>*{margin:1.5em}footer nav a img{vertical-align:middle}footer nav,footer p{font-size:90%}article{max-width:100%;padding:1.5em;width:37.5em;margin:0 auto}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;background:#2d2d2d}.token.comment,.token.doctype{color:#999}.token.punctuation{color:#ccc}.token.tag{color:#e2777a}.token.function,.token.number{color:#f08d49}.token.class-name,.token.property{color:#f8c555}.token.builtin{color:#cc99cd}.token.variable{color:#7ec699}.token.operator,.token.url{color:#67cdcc}.token.inserted{color:green}</style></head><body><header><nav><div id="nav"><h1><a href="/" title="Homepage">Fares' Blog</a></h1><a href="/about/">About</a></div><div id="reading-progress" aria-hidden="true"></div></nav><h1>Deploy an nginx server</h1><aside>4 min read.</aside><dialog id="message"></dialog></header><main><article><h3 id="deploy-an-nginx-server">Deploy an nginx server <a href="#deploy-an-nginx-server" class="direct-link">#</a></h3><p>I'll show you in this guide how to deploy an nginx server with detailed explanation on what's happening. This guide is for unix environments, I will do it on an ubuntu machine but it should be almost the same on any machine if you understand what's going on.</p><h4 id="install-nginx">Install nginx <a href="#install-nginx" class="direct-link">#</a></h4><p>First you will need to install nginx,</p><pre class="language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> nginx</code></pre><h4 id="verify-installation">Verify installation <a href="#verify-installation" class="direct-link">#</a></h4><p>First multiple things might happened depending on your platform, to verify the installation we first need to check the nginx file and look how it is behaving on your machine, so go check your <code>nginx.conf</code>&nbsp;file:</p><pre class="language-bash"><code class="language-bash"><span class="token function">cat</span> /etc/nginx/nginx.conf</code></pre><p>You should find under the http tag either a <code>server</code> tag or one ore multiple includes which will take care to include servers from other files. For example in my case I found these 2 lines but no <code>server</code> tag (might be different for you):</p><pre class="language-bash"><code class="language-bash">include /etc/nginx/conf.d/*.conf<span class="token punctuation">;</span><br>include /etc/nginx/sites-enabled/*<span class="token punctuation">;</span></code></pre><p>If you found a <code>server</code> tag, then good you can check the port it's listening to with the listen parameter:</p><pre class="language-bash"><code class="language-bash">    listen <span class="token number">80</span> default_server<span class="token punctuation">;</span></code></pre><p>If not, we can look inside the folders included (<code>/etc/nginx/conf.d/</code> and <code>/etc/nginx/sites-enabled/</code>). I found mine in <code>/etc/nginx/sites-enabled/default</code> (which is a simlink but I won't cover that in this tutorial because it used to confuse me at first and I want to keep this simple.)</p><p>So I look inside it</p><pre class="language-bash"><code class="language-bash"><span class="token function">cat</span> /etc/nginx/sites-enabled/default<br><br><span class="token punctuation">..</span>.<br>    listen <span class="token number">80</span> default_server<span class="token punctuation">;</span><br><span class="token punctuation">..</span>.</code></pre><p>Now to verify if everything worked correctly you can run your nginx application which will load the default files for you:</p><pre class="language-bash"><code class="language-bash">/etc/init.d/nginx start<br><br>or<br><br>systemctl start nginx</code></pre><p>Go to your browser and type <code>localhost:80</code>, (or the default port for you) you should find that "Welcome to nginx!" page. If you're on a server you can do <code>curl http://localhost:80</code></p><p>Okay, now we know nginx is working, whatever breaks after should be in our configuration file and not in our installation.</p><h4 id="let's-make-our-own-simple-configuration-from-scratch-(for-a-static-web-site)">Let's make our own simple configuration from scratch (for a static web site) <a href="#let's-make-our-own-simple-configuration-from-scratch-(for-a-static-web-site)" class="direct-link">#</a></h4><p>First, let's make a simple page that does nothing, create a file named <code>index.html</code> inside <code>/var/www/html/my_website/</code>, you can copy paste these 2 lines:</p><pre class="language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">mkdir</span> /var/www/html/my_website<br><span class="token function">sudo</span> <span class="token function">touch</span> /var/www/html/my_website/index.html</code></pre><p>Add some content to the file you just created, you can use whatever editor you like to open it and put this content in it (You can write an actual html file but I'll just write one line):</p><p>To open the file run this command (replace emacs with whatever editor you like, e,g: nano, gedit, vim):</p><pre class="language-bash"><code class="language-bash">emacs /var/www/html/my_website/index.html</code></pre><pre class="language-html"><code class="language-html">What's up doge;</code></pre><p>Second, make sure you got this line in your <code>/etc/nginx/nginx.conf</code>:</p><pre class="language-bash"><code class="language-bash">	include /etc/nginx/conf.d/*.conf<span class="token punctuation">;</span></code></pre><p>It indicates to nginx to include every configuration file that finishes with <code>.conf</code> inside the folder <code>conf.d/</code>.</p><p>Now let's clean our default configurations in there by removing the default server we found earlier (either directly inside <code>nginx.conf</code> or a standalone file inside <code>conf.d/</code> or <code>sites-enabled/</code>), in the case of standalone files you can delete the file or move it to your home directory if you want to play with it later, otherwise you can comment out the whole <code>server { ... }</code> bloc (by adding a <code>#</code> in the beginning)</p><p>Let's restart nginx with <code>systemctl restart nginx</code> or <code>/etc/init.d/nginx restart</code>, clean cache and head to <code>localhost:80</code> (or the port you found earlier). It shouldn't show the nginx welcome page anymore.</p><p>Now let's create our new configuration file for the fully functional website we just created:</p><p>Create a new nginx configuration file inside <code>/etc/nginx/conf.d/</code></p><pre class="language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">touch</span> /etc/nginx/conf.d/my_website.conf</code></pre><p>Let's add this content to it by opening the file (<code>sudo emacs /etc/nginx/conf.d/my_website.conf</code>) and copy pasting the next snippet:</p><pre class="language-bash"><code class="language-bash">server <span class="token punctuation">{</span><br>    listen <span class="token number">8081</span><span class="token punctuation">;</span><br>    server_name localhost<span class="token punctuation">;</span><br><br>    root /var/www/html/my_website<span class="token punctuation">;</span><br>    index index.html<span class="token punctuation">;</span><br><br>    location / <span class="token punctuation">{</span><br>        try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ <span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>Now if you head to your browser at the url <code>localhost:8081</code>, you can see <code>What's up</code> on the page.</p><p>Congratulation, you just deployed a website behind an nginx layer.</p><h4 id="nginx-as-a-reverse-proxy">Nginx as a reverse proxy <a href="#nginx-as-a-reverse-proxy" class="direct-link">#</a></h4><p>For the ones that want to use nginx as a reverse proxy, the base configuration is simpler:</p><pre class="language-bash"><code class="language-bash">server <span class="token punctuation">{</span><br>    listen <span class="token number">80</span><span class="token punctuation">;</span><br>    server_name localhost<span class="token punctuation">;</span><br><br>    location / <span class="token punctuation">{</span><br>        proxy_pass http://localhost:8080<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>This will pass all requests from the client on http to your server listening to port <code>8080</code>.</p><p>If you want to add <code>https</code> with a redirect from <code>http</code> to <code>https</code>, this applies if you can :</p><pre class="language-bash"><code class="language-bash">server <span class="token punctuation">{</span><br>    listen <span class="token number">443</span> ssl<span class="token punctuation">;</span><br>    server_name _<span class="token punctuation">;</span><br>    ssl_certificate /etc/nginx/conf.d/ssl/ssl.crt<span class="token punctuation">;</span><br>    ssl_certificate_key /etc/nginx/conf.d/ssl/ssl.key<span class="token punctuation">;</span><br><br>    location / <span class="token punctuation">{</span><br>        proxy_pass http://localhost:8080<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>server <span class="token punctuation">{</span><br>    listen <span class="token number">80</span><span class="token punctuation">;</span><br>    listen <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:80<span class="token punctuation">;</span><br>    server_name _<span class="token punctuation">;</span><br>    <span class="token builtin class-name">return</span> <span class="token number">301</span> https://<span class="token variable">$host</span><span class="token variable">$request_uri</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>NOTE: Replacing <code>server_name _;</code> with <code>server_name your_domain.com;</code> (a.k.a <code>server_name faresbessrour.com;</code> in my case) is not a bad idea. You can host many servers on the same machine.</p><p>Okay, thanx for reading! Hope this helped you.</p><p>If you have any comments, some step was ambiguous or any suggestions to fix or make this post better, please open an <a href="https://github.com/serafss2/serafss2.github.io/issues">issue</a>, I will be glad to hear from you!</p><h1>🙏🙏🙏</h1><p>Since you've made it this far, <a href="https://serafdev.github.io/posts/2019-03-11-Deploy-an-nginx-server/" on-click="share">sharing</a> this article on your favorite social media network would be highly appreciated 💖! For feedback, please <a href="https://twitter.com/@serafdev" rel="noopener" target="_blank">ping me on Twitter.</a></p><share-widget><button aria-label="Share" href="https://serafdev.github.io/posts/2019-03-11-Deploy-an-nginx-server/" on-click="share"><div></div></button></share-widget><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "Deploy an nginx server",
  "image": [],
  "author": "Fares B.", 
  "genre": "Insert a schema.org genre", 
  "publisher": {
    "@type": "Organization",
    "name": "Seraf Development.",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/favicon/favicon-192x192.png?hash=2089033c93"
    }
  },
  "url": "https://serafdev.github.io/posts/2019-03-11-Deploy-an-nginx-server/",
  "mainEntityOfPage": "https://serafdev.github.io/posts/2019-03-11-Deploy-an-nginx-server/",
  "datePublished": "2019-03-11",
  "dateModified": "2020-10-26",
  "description": "Deploy an nginx server # I&#39;ll show you in this guide how to deploy an nginx server with detailed explanation on what&#39;s happening. This guide..."
}</script><p>Published <time datetime="2019-03-11">11 Mar 2019</time></p></article></main><footer><a href="/about/">Fares B.</a></footer></body></html>